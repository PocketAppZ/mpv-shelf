(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{3702:function(e,t,n){Promise.resolve().then(n.bind(n,378))},8374:function(e,t,n){"use strict";n.d(t,{Go:function(){return u},N:function(){return R},Nk:function(){return w},Ny:function(){return r},QQ:function(){return m},Rf:function(){return o},VP:function(){return f},eu:function(){return T},he:function(){return g},lY:function(){return c},nS:function(){return N},oN:function(){return i},oY:function(){return x},oj:function(){return d},om:function(){return E},th:function(){return I},wZ:function(){return h},xe:function(){return p},xh:function(){return s},z7:function(){return L}});var a=n(7277),l=n(8251);async function o(){let e=await a.Z.load("sqlite:main.db");await e.execute("CREATE TABLE IF NOT EXISTS user \n        (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            pin TEXT NOT NULL,\n            imagePath TEXT,\n            color TEXT UNIQUE,\n            scrollY INTEGER DEFAULT 0\n        )");let t=[];try{t=await e.select("SELECT * from user")}catch(e){console.log(e)}return 0!==t.length?(console.log("confirmed users",t),t):null}async function r(e){let{userPin:t,formData:n}=e,o=await a.Z.load("sqlite:main.db");console.log("Attemping to create new user");try{await o.execute("\n        CREATE TABLE IF NOT EXISTS user \n        (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            pin TEXT NOT NULL,\n            imagePath TEXT,\n            color TEXT UNIQUE, \n            scrollY INTEGER DEFAULT 0\n        )");let e="";await (0,l.dw)("generate_random_color").then(async n=>{await o.execute("INSERT OR IGNORE INTO user (pin, color) VALUES ($1, $2)",[t,n]).then(()=>{e=n.toString()})}),""!==e&&await o.select("SELECT * from user WHERE color = $1",[e]).then(async e=>(1===e.length&&f({formData:n,userId:e[0].id}),await o.close(),e))}catch(e){return console.log(e),await o.close(),!1}}async function i(e){let{userId:t,folderPath:n,expanded:o,asChild:r}=e,i=await a.Z.load("sqlite:main.db");await i.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await (0,l.dw)("generate_random_mono_color").then(async e=>{await i.execute("INSERT into folder (expanded, path, userId, asChild, color) VALUES ($1, $2, $3, $4, $5)",[o?1:0,n,t,r?1:0,e]).then(()=>{console.log("Created New Folder: ",n.split("\\").pop(),"expanded:",o,"for user",t)}).catch(async e=>(await i.close(),console.log(e),!1))})}async function s(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{await n.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)});try{let e=await n.select("SELECT * from folder WHERE userId = $1",[t]);if(console.log("getFolders() => Folders found from user ".concat(t,":"),e.length),0!==e.length)return e;return[]}catch(e){return await n.close(),console.log(e),[]}}catch(e){return await n.close(),console.log(e),[]}}async function c(e){let{userId:t,folderPath:n,expanded:o,asChild:r}=e,i=await a.Z.load("sqlite:main.db");return await i.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await i.select("SELECT * from folder WHERE PATH = $1 AND userId = $2",[n,t]).then(async e=>{console.log("folders",e),Array.isArray(e)&&0!==e.length?(await i.execute("UPDATE folder SET expanded = $1 WHERE path = $2 AND userId = $3",[o?1:0,n,t]),console.log("Updated",n.split("\\").pop(),"expanded:",o,"for user",t)):await (0,l.dw)("generate_random_mono_color").then(async e=>{await i.execute("INSERT into folder (expanded, path, userId, asChild, color) VALUES ($1, $2, $3, $4, $5)",[o?1:0,n,t,r?1:0,e]).then(()=>{console.log("Created New Folder: ",n.split("\\").pop(),"expanded:",o,"for user",t)}).catch(async e=>(await i.close(),console.log(e),!1))})}),!0}async function d(e){let{videoPath:t,user:n,watched:l}=e;console.log("Updating watched: ",t.split("\\").pop(),"as",l,"for user",n.id);let o=await a.Z.load("sqlite:main.db");try{await o.execute("\n            CREATE TABLE IF NOT EXISTS video (\n                id INTEGER PRIMARY KEY AUTOINCREMENT, \n                path TEXT NOT NULL, \n                userId INTEGER,\n                watched BOOLEAN NOT NULL DEFAULT 0,\n                lastWatchedAt TIMESTAMP DEFAULT (datetime('now')),\n                FOREIGN KEY (userId) REFERENCES user(id)\n            )\n        ");let e=await o.select("SELECT * from video WHERE path = $1 AND userId = $2",[t,n.id]);0===e.length?await o.execute("INSERT INTO video (path, userId, watched, lastWatchedAt) VALUES ($1, $2, $3, (datetime('now')))",[t,n.id,l?1:0]):await o.execute("UPDATE video SET watched = $3, lastWatchedAt = (datetime('now')) WHERE path = $1 AND userId = $2",[t,n.id,l?1:0])}catch(e){return await o.close(),console.error(e),!1}return!0}async function u(e){let{folderPath:t}=e,n=await a.Z.load("sqlite:main.db");await n.execute("DELETE from folder WHERE path = $1",[t])}async function E(e){let{videoPath:t,userId:n}=e,l=await a.Z.load("sqlite:main.db"),o=[];try{return await l.execute("\n            CREATE TABLE IF NOT EXISTS video (\n                id INTEGER PRIMARY KEY AUTOINCREMENT, \n                path TEXT NOT NULL, \n                userId INTEGER,\n                watched BOOLEAN NOT NULL DEFAULT 0,\n                lastWatchedAt TIMESTAMP DEFAULT (datetime('now')),\n                FOREIGN KEY (userId) REFERENCES user(id)\n            )\n        "),(o=await l.select("SELECT * from video WHERE path = $1 AND userId = $2",[t,n]))[0]}catch(e){console.log(e)}return o&&0!==o.length?o[0]:null}async function f(e){let{formData:t,userId:n}=e,l=await a.Z.load("sqlite:main.db");console.log("updating settings for user:",n),await l.execute("\n    CREATE TABLE IF NOT EXISTS settings (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL UNIQUE, \n    theme TEXT NOT NULL, \n    fontSize TEXT NOT NULL, \n    animations TEXT NOT NULL, \n    autoRename TEXT NOT NULL, \n    usePin TEXT NOT NULL,\n    FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await l.execute("\n        INSERT INTO settings (userId, theme, fontSize, animations, autoRename, usePin)\n        VALUES ($1, $2, $3, $4, $5, $6)\n        ON CONFLICT(userId) DO UPDATE SET\n        theme = excluded.theme,\n        fontSize = excluded.fontSize,\n        animations = excluded.animations,\n        autoRename = excluded.autoRename,\n        usePin = excluded.usePin\n    ",[n,t.theme,t.fontSize,t.animations,t.autoRename,t.usePin]).catch(e=>{console.log("error",e)})}async function T(e){let{userId:t,newPin:n}=e,l=await a.Z.load("sqlite:main.db");await l.execute("UPDATE user SET pin = $1 WHERE id = $2",[n,t]),await l.close()}async function N(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{await n.execute("\n    CREATE TABLE IF NOT EXISTS settings (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL UNIQUE, \n    theme TEXT NOT NULL, \n    fontSize TEXT NOT NULL, \n    animations TEXT NOT NULL, \n    autoRename TEXT NOT NULL, \n    usePin TEXT NOT NULL,\n    FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)});let e=await n.select("SELECT * from settings WHERE userId = $1",[t]);if(0===e.length)return null;return e[0]}catch(e){return console.log(e),null}}async function h(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");await n.execute("UPDATE settings SET usePin = 'On' WHERE userId = $1",[t]),await n.close()}async function x(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{await n.execute("\n            CREATE TABLE IF NOT EXISTS global (\n                id TEXT PRIMARY KEY, \n                userId INTEGER NOT NULL\n            )\n        "),await n.execute("\n            INSERT INTO global (id, userId) \n            VALUES ($1, $2)\n            ON CONFLICT(id) DO UPDATE SET \n            userId = excluded.userId\n        ",["GID99844589388427",t])}catch(e){return await n.close(),console.log(e),!1}return!0}async function m(){let e=await a.Z.load("sqlite:main.db");try{await e.execute("\n        CREATE TABLE IF NOT EXISTS global (\n        id TEXT PRIMARY KEY, \n        userId INTEGER NOT NULL\n        )");let t=await e.select("SELECT * from global WHERE id = $1",["GID99844589388427"]);if(t)return t[0];return null}catch(t){return await e.close(),console.log(t),null}}async function w(e){let{userId:t,imagePath:n}=e,o=await a.Z.load("sqlite:main.db"),r=(0,l.Lk)(n);await o.execute("UPDATE user SET imagePath = $1 WHERE id = $2",[r,t]),await o.close()}async function g(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{await n.execute("DELETE FROM folder WHERE userId = $1",[t]),await n.execute("DELETE FROM settings WHERE userId = $1",[t]),await n.execute("DELETE FROM video WHERE userId = $1",[t]),await n.execute("DELETE FROM user WHERE id = $1",[t]),console.log("deleteProfile() => Deleted user:",t)}catch(e){await n.close(),console.log(e)}finally{await n.close()}}async function I(e){let{userId:t,scrollY:n}=e,l=await a.Z.load("sqlite:main.db");await l.execute("UPDATE user SET scrollY = $1 WHERE id = $2",[n,t])}async function R(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{let e=await n.select("SELECT scrollY from user WHERE id = $1",[t]);if(e)return e[0].scrollY}catch(e){return console.log(e),await n.close(),null}}async function L(e){let{userId:t}=e,n=await a.Z.load("sqlite:main.db");try{let e=await n.select("SELECT * from video WHERE userId = $1",[t]);if(0!==e.length)return e;return[]}catch(e){return console.log(e),await n.close(),null}}async function p(){let e=await a.Z.load("sqlite:main.db");await e.close()}},378:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var a=n(3827),l=n(4090),o=n(8374),r=n(7907),i=n(7904),s=n(575),c=n(9259),d=n(1348),u=n(2684),E=n(2169);function f(){let e=(0,r.useRouter)();function t(e){let{userPin:t,userId:n}=e,f=["Just a Second!","Wait a Moment!","Hold On!"],T=["Final Step!","The Last One!","Just One More!","Any Second Now!","One More Step!"],N=(0,r.useRouter)(),[h,x]=(0,l.useState)([,,,,].fill("")),m=[,,,,].fill(0).map(()=>(0,l.createRef)()),[w,g]=(0,l.useState)(),[I,R]=(0,l.useState)(!0);(0,l.useEffect)(()=>{m[0]&&m[0].current&&m[0].current.focus()},[]),(0,l.useEffect)(()=>{R(!0),(0,o.Rf)().then(e=>{if(e){for(let t of e)if(t.id===n){g(t),R(!1);break}}}).finally(()=>{R(!1)})},[n]),(0,l.useEffect)(()=>{4===h.join("").length&&!1===I?h.join("")===t&&(N.prefetch("/dashboard"),R(!0),(0,o.oY)({userId:n}).then(e=>{!0==e&&(R(!1),(0,o.xe)().then(()=>{N.push("/dashboard",{scroll:!1})}))})):"disabled"!==t||I||(N.prefetch("/dashboard"),R(!0),(0,o.oY)({userId:n}).then(e=>{!0==e&&(R(!1),(0,o.xe)().then(()=>{N.push("/dashboard",{scroll:!1})}))}))},[h,I,t,n,N]);let L=(e,t)=>{let n=[...h];n[t]=e,x(n),m&&1===e.length&&t<3&&m[t+1].current.focus()},p=(e,t)=>{if("Backspace"===e.key&&!h[t]&&t>0){let e=[...h];e[t-1]="",x(e),m[t-1].current.focus()}"Backspace"===e.key&&3===t&&h[t]&&(console.log("backspace pressed"),x([,,,,].fill("")),m[0].current.focus())};return(0,a.jsx)("main",{className:"mt-4 flex h-full w-full items-center justify-center",children:(0,a.jsx)(d.M,{mode:"wait",onExitComplete:()=>{},children:h.join("")!==t?(0,a.jsxs)(u.E.div,{className:"flex h-full w-full flex-col items-center justify-center gap-3",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.5,bounce:.5,type:"spring"},children:[(0,a.jsxs)("h1",{className:"w=full h-full select-none py-4 text-center text-4xl font-bold drop-shadow-sm md:text-5xl lg:text-[3.25rem] xl:text-6xl",children:[3===h.join("").length&&T[Math.floor(Math.random()*T.length)],h.join("").length<3&&f[Math.floor(Math.random()*f.length)],(0,a.jsx)(d.M,{children:(0,a.jsx)(u.E.div,{animate:4===h.join("").length&&h.join("")!==t?{x:[0,-10,0,10,0]}:void 0,transition:{duration:.2},className:"text-destructive drop-shadow-md md:text-4xl lg:text-5xl xl:text-6xl",children:4===h.join("").length&&h.join("")!==t&&["Try Again!","Incorrect!","One More Time!","Not Quite!","Close!","Missed It!"][Math.floor(Math.random()*f.length)]},"failed-text")})]}),n&&w&&(0,a.jsx)("div",{className:"",children:(0,a.jsx)(i.UserAvatar,{userObject:w})}),(0,a.jsx)(u.E.div,{className:"mt-2 flex space-x-2",animate:4===h.join("").length&&h.join("")!==t?{x:[0,-10,0,10,0]}:void 0,transition:{duration:.2},children:h.map((e,n)=>(0,a.jsx)("input",{ref:m[n],type:"tel",maxLength:1,value:e,onChange:e=>L(e.target.value,n),onKeyDown:e=>p(e,n),className:(0,E.cn)("h-20 w-20 rounded border-2 border-muted text-center text-4xl md:h-28 md:w-28 md:text-6xl lg:h-36 lg:w-36 lg:text-8xl xl:h-40 xl:w-40 xl:text-8xl shadow-md font-bold",4===h.join("").length&&h.join("")!==t&&"border-red-500 focus:outline-none focus:border-red-500"),pattern:"\\d{4,4}"},n))}),(0,a.jsxs)("h2",{className:"mb-1 text-xl font-medium md:text-2xl lg:text-3xl xl:text-4xl",children:["Enter a ",(0,a.jsx)("b",{children:"pin #"})," to protect your account."]}),(0,a.jsx)("div",{className:"flex w-full flex-row items-center justify-center",children:(0,a.jsx)(s.z,{variant:"outline",className:"cursor-pointer rounded-lg px-2 py-0 text-lg font-bold text-blue-500 underline underline-offset-2 shadow-sm md:text-2xl lg:text-3xl xl:text-4xl",onClick:()=>{},children:"Forgot Pin?"})})]},"NotSignedIn"):(0,a.jsx)(u.E.div,{className:"mt-3 flex h-full w-full flex-col items-center justify-center rounded-full bg-monotone",initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},transition:{duration:.5,ease:"easeInOut",stiffness:100,damping:20},children:(0,a.jsx)(c.Z,{className:"flex h-auto w-60 items-center justify-center text-center text-accent"})},"SignedIn")})})}return(0,a.jsx)("main",{className:"flex h-fit items-center justify-center p-1 px-2",children:(0,a.jsx)(function(){let[n,r]=(0,l.useState)(),[i,s]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{(0,o.Rf)().then(e=>{e&&e.length>0&&r(e),s(!1)})},[]),(0,l.useEffect)(()=>{i||(null==n?void 0:n.length)!==0&&void 0!==n?!i&&n&&(null==n?void 0:n.length)>1&&(console.log("multiple users found"),(0,o.QQ)().then(t=>{if(t&&(null==t?void 0:t.userId)!==-1&&n)for(let e of n)e.id===t.userId&&(r([]),r([e]),(0,o.oY)({userId:-1}));else i||e.push("/profiles",{scroll:!1})})):e.push("/profiles/newUser",{scroll:!1})},[n,i]),!i&&(null==n?void 0:n.length)===1&&null!==n[0].pin)return(0,a.jsx)("main",{className:"flex flex-col items-center justify-center",children:(0,a.jsx)(t,{userPin:n[0].pin,userId:n[0].id})})},{})})}},7904:function(e,t,n){"use strict";n.r(t),n.d(t,{UserAvatar:function(){return f}});var a=n(3827),l=n(4090),o=n(2178),r=n(2169);let i=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,a.jsx)(o.fC,{ref:t,className:(0,r.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...l})});i.displayName=o.fC.displayName;let s=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,a.jsx)(o.Ee,{ref:t,className:(0,r.cn)("aspect-square h-full w-full",n),...l})});s.displayName=o.Ee.displayName;let c=l.forwardRef((e,t)=>{let{className:n,...l}=e;return(0,a.jsx)(o.NY,{ref:t,className:(0,r.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...l})});c.displayName=o.NY.displayName;var d=n(1213),u=n(3854),E=n(7907);function f(e){let{userObject:t,asChild:n}=e,l=(0,E.usePathname)();return console.log("userAvatar"),(0,a.jsxs)(i,{className:(0,r.cn)("h-auto w-40 text-xl font-medium rounded-sm md:w-52 lg:w-64 xl:w-80 flex justify-center items-center outline drop-shadow-lg shadow-md text-background",n&&"h-auto w-full text-lg font-medium outline rounded",n&&(null==t?void 0:t.imagePath)&&"md:w-3/4 rounded-none",n&&(null==t?void 0:t.imagePath)&&"h-40 md:w-40 rounded-sm",n&&!(null==t?void 0:t.imagePath)&&"outline drop-shadow-md",n&&t.imagePath&&"w-full outline-none"),children:[(0,a.jsx)(s,{src:(null==t?void 0:t.imagePath)?null==t?void 0:t.imagePath:"",alt:null==t?void 0:t.id.toString(),className:(0,r.cn)("object-cover drop-shadow-md",n&&"w-5/6 lg:w-[60%]")}),(0,a.jsx)(c,{className:(0,r.cn)("h-40 w-40 text-xl font-medium rounded-sm select-none flex justify-center items-center",n&&"w-full text-lg font-medium",!n&&"md:w-52\n                 md:h-52  \n                 lg:w-64 \n                 lg:h-64\n                 xl:h-80\n                 xl:w-80",l.includes("/login")&&"h-40 w-40"),children:(0,a.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",style:{backgroundColor:"".concat(null==t?void 0:t.color)},children:[(0,a.jsx)("span",{className:(0,r.cn)("flex outline outline-2 text-center  \n                        md:text-2xl \n                        md:pb-0.5\n                        lg:text-4xl\n                        lg:mt-3\n                        xl:pb-1.5\n                        xl:text-5xl \n                        rounded-sm px-2 font-bold text-lg\n                        drop-shadow-md",!(null==t?void 0:t.id)&&"outline-none shadow-none",n&&"text-lg md:text-xl lg:text-2xl xl:text-3xl"),children:null==t?void 0:t.id}),(null==t?void 0:t.id)?(0,a.jsx)(d.Z,{className:"h-auto w-1/2 drop-shadow-md",strokeWidth:1.3}):(0,a.jsx)(u.Z,{className:"h-auto w-1/2 text-tertiary drop-shadow-md",strokeWidth:1.3})]})})]})}},575:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var a=n(3827),l=n(4090),o=n(9143),r=n(7742),i=n(2169);let s=(0,r.j)("inline-flex items-center justify-center whitespace-nowrap rounded-sm text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=l.forwardRef((e,t)=>{let{className:n,variant:l,size:r,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(s({variant:l,size:r,className:n})),ref:t,...d})});c.displayName="Button"},2169:function(e,t,n){"use strict";n.d(t,{cn:function(){return o}});var a=n(3167),l=n(1367);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,l.m6)((0,a.W)(t))}}},function(e){e.O(0,[247,851,593,971,69,744],function(){return e(e.s=3702)}),_N_E=e.O()}]);
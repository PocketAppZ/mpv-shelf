(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{9988:function(e,t,n){Promise.resolve().then(n.bind(n,4706))},8374:function(e,t,n){"use strict";n.d(t,{Go:function(){return E},N:function(){return g},Nk:function(){return p},Ny:function(){return l},QQ:function(){return x},Rf:function(){return i},VP:function(){return f},eu:function(){return T},he:function(){return R},lY:function(){return s},nS:function(){return h},oN:function(){return o},oY:function(){return m},oj:function(){return u},om:function(){return d},th:function(){return w},wZ:function(){return N},xe:function(){return L},xh:function(){return c},z7:function(){return I}});var r=n(7277),a=n(8251);async function i(){let e=await r.Z.load("sqlite:main.db");await e.execute("CREATE TABLE IF NOT EXISTS user \n        (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            pin TEXT NOT NULL,\n            imagePath TEXT,\n            color TEXT UNIQUE,\n            scrollY INTEGER DEFAULT 0\n        )");let t=[];try{t=await e.select("SELECT * from user")}catch(e){console.log(e)}return 0!==t.length?(console.log("confirmed users",t),t):null}async function l(e){let{userPin:t,formData:n}=e,i=await r.Z.load("sqlite:main.db");console.log("Attemping to create new user");try{await i.execute("\n        CREATE TABLE IF NOT EXISTS user \n        (\n            id INTEGER PRIMARY KEY AUTOINCREMENT,\n            pin TEXT NOT NULL,\n            imagePath TEXT,\n            color TEXT UNIQUE, \n            scrollY INTEGER DEFAULT 0\n        )");let e="";await (0,a.dw)("generate_random_color").then(async n=>{await i.execute("INSERT OR IGNORE INTO user (pin, color) VALUES ($1, $2)",[t,n]).then(()=>{e=n.toString()})}),""!==e&&await i.select("SELECT * from user WHERE color = $1",[e]).then(async e=>(1===e.length&&f({formData:n,userId:e[0].id}),await i.close(),e))}catch(e){return console.log(e),await i.close(),!1}}async function o(e){let{userId:t,folderPath:n,expanded:i,asChild:l}=e,o=await r.Z.load("sqlite:main.db");await o.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await (0,a.dw)("generate_random_mono_color").then(async e=>{await o.execute("INSERT into folder (expanded, path, userId, asChild, color) VALUES ($1, $2, $3, $4, $5)",[i?1:0,n,t,l?1:0,e]).then(()=>{console.log("Created New Folder: ",n.split("\\").pop(),"expanded:",i,"for user",t)}).catch(async e=>(await o.close(),console.log(e),!1))})}async function c(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{await n.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)});try{let e=await n.select("SELECT * from folder WHERE userId = $1",[t]);if(console.log("getFolders() => Folders found from user ".concat(t,":"),e.length),0!==e.length)return e;return[]}catch(e){return await n.close(),console.log(e),[]}}catch(e){return await n.close(),console.log(e),[]}}async function s(e){let{userId:t,folderPath:n,expanded:i,asChild:l}=e,o=await r.Z.load("sqlite:main.db");return await o.execute("CREATE TABLE IF NOT EXISTS folder (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL, path TEXT NOT NULL, expanded BOOLEAN NOT NULL DEFAULT 0, asChild BOOLEAN NOT NULL DEFAULT 0, color TEXT, FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await o.select("SELECT * from folder WHERE PATH = $1 AND userId = $2",[n,t]).then(async e=>{console.log("folders",e),Array.isArray(e)&&0!==e.length?(await o.execute("UPDATE folder SET expanded = $1 WHERE path = $2 AND userId = $3",[i?1:0,n,t]),console.log("Updated",n.split("\\").pop(),"expanded:",i,"for user",t)):await (0,a.dw)("generate_random_mono_color").then(async e=>{await o.execute("INSERT into folder (expanded, path, userId, asChild, color) VALUES ($1, $2, $3, $4, $5)",[i?1:0,n,t,l?1:0,e]).then(()=>{console.log("Created New Folder: ",n.split("\\").pop(),"expanded:",i,"for user",t)}).catch(async e=>(await o.close(),console.log(e),!1))})}),!0}async function u(e){let{videoPath:t,user:n,watched:a}=e;console.log("Updating watched: ",t.split("\\").pop(),"as",a,"for user",n.id);let i=await r.Z.load("sqlite:main.db");try{await i.execute("\n            CREATE TABLE IF NOT EXISTS video (\n                id INTEGER PRIMARY KEY AUTOINCREMENT, \n                path TEXT NOT NULL, \n                userId INTEGER,\n                watched BOOLEAN NOT NULL DEFAULT 0,\n                lastWatchedAt TIMESTAMP DEFAULT (datetime('now')),\n                FOREIGN KEY (userId) REFERENCES user(id)\n            )\n        ");let e=await i.select("SELECT * from video WHERE path = $1 AND userId = $2",[t,n.id]);0===e.length?await i.execute("INSERT INTO video (path, userId, watched, lastWatchedAt) VALUES ($1, $2, $3, (datetime('now')))",[t,n.id,a?1:0]):await i.execute("UPDATE video SET watched = $3, lastWatchedAt = (datetime('now')) WHERE path = $1 AND userId = $2",[t,n.id,a?1:0])}catch(e){return await i.close(),console.error(e),!1}return!0}async function E(e){let{folderPath:t}=e,n=await r.Z.load("sqlite:main.db");await n.execute("DELETE from folder WHERE path = $1",[t])}async function d(e){let{videoPath:t,userId:n}=e,a=await r.Z.load("sqlite:main.db"),i=[];try{return await a.execute("\n            CREATE TABLE IF NOT EXISTS video (\n                id INTEGER PRIMARY KEY AUTOINCREMENT, \n                path TEXT NOT NULL, \n                userId INTEGER,\n                watched BOOLEAN NOT NULL DEFAULT 0,\n                lastWatchedAt TIMESTAMP DEFAULT (datetime('now')),\n                FOREIGN KEY (userId) REFERENCES user(id)\n            )\n        "),(i=await a.select("SELECT * from video WHERE path = $1 AND userId = $2",[t,n]))[0]}catch(e){console.log(e)}return i&&0!==i.length?i[0]:null}async function f(e){let{formData:t,userId:n}=e,a=await r.Z.load("sqlite:main.db");console.log("updating settings for user:",n),await a.execute("\n    CREATE TABLE IF NOT EXISTS settings (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL UNIQUE, \n    theme TEXT NOT NULL, \n    fontSize TEXT NOT NULL, \n    animations TEXT NOT NULL, \n    autoRename TEXT NOT NULL, \n    usePin TEXT NOT NULL,\n    FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)}),await a.execute("\n        INSERT INTO settings (userId, theme, fontSize, animations, autoRename, usePin)\n        VALUES ($1, $2, $3, $4, $5, $6)\n        ON CONFLICT(userId) DO UPDATE SET\n        theme = excluded.theme,\n        fontSize = excluded.fontSize,\n        animations = excluded.animations,\n        autoRename = excluded.autoRename,\n        usePin = excluded.usePin\n    ",[n,t.theme,t.fontSize,t.animations,t.autoRename,t.usePin]).catch(e=>{console.log("error",e)})}async function T(e){let{userId:t,newPin:n}=e,a=await r.Z.load("sqlite:main.db");await a.execute("UPDATE user SET pin = $1 WHERE id = $2",[n,t]),await a.close()}async function h(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{await n.execute("\n    CREATE TABLE IF NOT EXISTS settings (id INTEGER PRIMARY KEY AUTOINCREMENT, userId INTEGER NOT NULL UNIQUE, \n    theme TEXT NOT NULL, \n    fontSize TEXT NOT NULL, \n    animations TEXT NOT NULL, \n    autoRename TEXT NOT NULL, \n    usePin TEXT NOT NULL,\n    FOREIGN KEY (userId) REFERENCES user(id))").catch(e=>{console.log("error",e)});let e=await n.select("SELECT * from settings WHERE userId = $1",[t]);if(0===e.length)return null;return e[0]}catch(e){return console.log(e),null}}async function N(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");await n.execute("UPDATE settings SET usePin = 'On' WHERE userId = $1",[t]),await n.close()}async function m(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{await n.execute("\n            CREATE TABLE IF NOT EXISTS global (\n                id TEXT PRIMARY KEY, \n                userId INTEGER NOT NULL\n            )\n        "),await n.execute("\n            INSERT INTO global (id, userId) \n            VALUES ($1, $2)\n            ON CONFLICT(id) DO UPDATE SET \n            userId = excluded.userId\n        ",["GID99844589388427",t])}catch(e){return await n.close(),console.log(e),!1}return!0}async function x(){let e=await r.Z.load("sqlite:main.db");try{await e.execute("\n        CREATE TABLE IF NOT EXISTS global (\n        id TEXT PRIMARY KEY, \n        userId INTEGER NOT NULL\n        )");let t=await e.select("SELECT * from global WHERE id = $1",["GID99844589388427"]);if(t)return t[0];return null}catch(t){return await e.close(),console.log(t),null}}async function p(e){let{userId:t,imagePath:n}=e,i=await r.Z.load("sqlite:main.db"),l=(0,a.Lk)(n);await i.execute("UPDATE user SET imagePath = $1 WHERE id = $2",[l,t]),await i.close()}async function R(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{await n.execute("DELETE FROM folder WHERE userId = $1",[t]),await n.execute("DELETE FROM settings WHERE userId = $1",[t]),await n.execute("DELETE FROM video WHERE userId = $1",[t]),await n.execute("DELETE FROM user WHERE id = $1",[t]),console.log("deleteProfile() => Deleted user:",t)}catch(e){await n.close(),console.log(e)}finally{await n.close()}}async function w(e){let{userId:t,scrollY:n}=e,a=await r.Z.load("sqlite:main.db");await a.execute("UPDATE user SET scrollY = $1 WHERE id = $2",[n,t])}async function g(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{let e=await n.select("SELECT scrollY from user WHERE id = $1",[t]);if(e)return e[0].scrollY}catch(e){return console.log(e),await n.close(),null}}async function I(e){let{userId:t}=e,n=await r.Z.load("sqlite:main.db");try{let e=await n.select("SELECT * from video WHERE userId = $1",[t]);if(0!==e.length)return e;return[]}catch(e){return console.log(e),await n.close(),null}}async function L(){let e=await r.Z.load("sqlite:main.db");await e.close()}},8994:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,n(7461).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4706:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(3827),a=n(4090),i=n(8374),l=n(1348),o=n(2684),c=n(7907);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,n(7461).Z)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var u=n(8994),E=n(2169);let d=(0,a.lazy)(()=>n.e(904).then(n.bind(n,7904)).then(e=>({default:e.UserAvatar})));function f(){let e=(0,c.useRouter)(),[t,n]=(0,a.useState)([]),[f,T]=(0,a.useState)(!0),[h,N]=(0,a.useState)(!1),m=(0,a.useRef)(null),x=(0,a.useRef)(null),p=(0,a.useRef)(null),[R,w]=(0,a.useState)(0);return(0,a.useEffect)(()=>{0===t.length&&(0,i.xe)().then(()=>{(0,i.Rf)().then(e=>{e&&(0,i.xe)().then(()=>{n(e),T(!1)})})})},[t.length]),(0,a.useEffect)(()=>{let e=()=>{if(m.current&&p.current){let{width:e}=m.current.getBoundingClientRect(),{height:t}=m.current.getBoundingClientRect();window.innerHeight,w(p.current.clientWidth-e)}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,r.jsx)(l.M,{children:(0,r.jsx)(o.E.main,{className:(0,E.cn)("flex w-full flex-col items-center justify-center gap-2 overflow-hidden relative select-none shadow-2xl ",t.length>=3&&"items-start"),ref:m,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},children:(0,r.jsxs)("div",{ref:x,className:"w-full",children:[(0,r.jsxs)("div",{className:(0,E.cn)("mt-7 h-full w-full flex flex-col justify-center items-center"),children:[(0,r.jsx)("h1",{className:"animate-gradient-x select-none bg-[linear-gradient(to_right,theme(colors.zinc.600),theme(colors.gray.400),theme(colors.zinc.700),theme(colors.stone.700),theme(colors.stone.300),theme(colors.zinc.300),#333)] bg-[length:200%_auto] bg-clip-text text-center text-4xl font-extrabold text-transparent drop-shadow-lg md:text-5xl lg:text-6xl xl:text-6xl 2xl:text-7xl",children:"Welcome Back!"}),(0,r.jsx)("h2",{className:"animate-gradient-xr select-none bg-[linear-gradient(to_right,theme(colors.zinc.300),theme(colors.gray.100),theme(colors.zinc.400),theme(colors.stone.200),theme(colors.stone.300),theme(colors.white))] bg-[length:200%_auto] bg-clip-text text-center text-2xl font-extrabold text-transparent drop-shadow-lg md:text-2xl lg:text-3xl xl:text-4xl 2xl:text-4xl",children:"Select Your Profile From The Users Below"})]}),(0,r.jsxs)(o.E.div,{className:(0,E.cn)("relative flex flex-col h-full w-full justify-start items-center py-5 brow rounded-sm pb-8 bg-transparent drop-shadow-md px-4",t.length>=3&&"items-start cursor-grab w-fit",t.length>=3&&h&&"cursor-grabbing"),ref:p,initial:t.length>=3?{x:20}:void 0,animate:t.length>=3?{x:20}:void 0,exit:t.length>=3?{y:-50}:void 0,drag:R>0?"x":void 0,...t.length>=3&&{drag:"x"},dragConstraints:x,dragTransition:{bounceStiffness:600,bounceDamping:20},dragElastic:.5,onDragStart:(e,t)=>{N(!0)},onDragEnd:()=>{N(!1)},transition:{duration:.5,bounce:.5,type:"spring",damping:100},children:[0!==t.length&&(0,r.jsx)(o.E.div,{className:(0,E.cn)("w-full flex flex-col gap-4 justify-center items-start pt-2 pb-40 relative"),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,r.jsxs)("div",{className:"flex h-full w-full flex-row items-center justify-center gap-6",children:[t.map((n,a)=>(0,r.jsxs)("div",{className:"flex flex-row items-center justify-center text-background",onClick:t=>{t.preventDefault(),h||(e.prefetch("/login"),(0,i.oY)({userId:n.id}).then(()=>(0,i.xe)()).finally(()=>{e.push("/login",{scroll:!1})}))},children:[(0,r.jsx)(o.E.button,{className:(0,E.cn)("flex h-fit w-fit flex-row items-center justify-center",h&&"cursor-grabbing"),whileHover:{y:10},whileTap:{scale:.95},transition:{duration:.5,bounce:.5,type:"spring"},children:(0,r.jsx)(d,{userObject:n})},n.id),a!==t.length&&t.length>=3&&(0,r.jsx)(s,{className:"h-auto w-12 px-0 text-background"})]},1e3*n.id+a)),(0,r.jsx)("div",{className:"flex flex-row items-center justify-center",onClick:t=>{t.preventDefault(),h||(e.prefetch("/profiles/newUser"),(0,i.oY)({userId:-1}).then(()=>(0,i.xe)()).finally(()=>{e.push("/profiles/newUser",{scroll:!1})}))},children:(0,r.jsx)(o.E.button,{className:(0,E.cn)("flex h-fit w-fit flex-row items-center justify-center",h&&"cursor-grabbing"),whileHover:{y:10},whileTap:{scale:.95},transition:{duration:.5,bounce:.5,type:"spring"},children:(0,r.jsx)(d,{userObject:t[99]})},"add-prfile2")},"add profile")]})}),f&&(0,r.jsx)(o.E.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{scale:0,opacity:0},children:(0,r.jsx)(u.Z,{className:"h-auto w-20 animate-spin text-accent"})})]})]})},"main")})}},2169:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var r=n(3167),a=n(1367);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}},1348:function(e,t,n){"use strict";n.d(t,{M:function(){return N}});var r=n(4090),a=n(5526);function i(){let e=(0,r.useRef)(!1);return(0,a.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var l=n(4205),o=n(4561),c=n(2435);class s extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:n}=e,a=(0,r.useId)(),i=(0,r.useRef)(null),l=(0,r.useRef)({width:0,height:0,top:0,left:0});return(0,r.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:o}=l.current;if(n||!i.current||!e||!t)return;i.current.dataset.motionPopId=a;let c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule('\n          [data-motion-pop-id="'.concat(a,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(r,"px !important;\n            left: ").concat(o,"px !important;\n          }\n        ")),()=>{document.head.removeChild(c)}},[n]),r.createElement(s,{isPresent:n,childRef:i,sizeRef:l},r.cloneElement(t,{ref:i}))}let E=e=>{let{children:t,initial:n,isPresent:a,onExitComplete:i,custom:l,presenceAffectsLayout:s,mode:E}=e,f=(0,c.h)(d),T=(0,r.useId)(),h=(0,r.useMemo)(()=>({id:T,initial:n,isPresent:a,custom:l,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;i&&i()},register:e=>(f.set(e,!1),()=>f.delete(e))}),s?void 0:[a]);return(0,r.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[a]),r.useEffect(()=>{a||f.size||!i||i()},[a]),"popLayout"===E&&(t=r.createElement(u,{isPresent:a},t)),r.createElement(o.O.Provider,{value:h},t)};function d(){return new Map}var f=n(3856),T=n(9908);let h=e=>e.key||"",N=e=>{var t;let{children:n,custom:o,initial:c=!0,onExitComplete:s,exitBeforeEnter:u,presenceAffectsLayout:d=!0,mode:N="sync"}=e;(0,T.k)(!u,"Replace exitBeforeEnter with mode='wait'");let m=(0,r.useContext)(f.p).forceRender||function(){let e=i(),[t,n]=(0,r.useState)(0),a=(0,r.useCallback)(()=>{e.current&&n(t+1)},[t]);return[(0,r.useCallback)(()=>l.Wi.postRender(a),[a]),t]}()[0],x=i(),p=function(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}(n),R=p,w=(0,r.useRef)(new Map).current,g=(0,r.useRef)(R),I=(0,r.useRef)(new Map).current,L=(0,r.useRef)(!0);if((0,a.L)(()=>{L.current=!1,function(e,t){e.forEach(e=>{let n=h(e);t.set(n,e)})}(p,I),g.current=R}),t=()=>{L.current=!0,I.clear(),w.clear()},(0,r.useEffect)(()=>()=>t(),[]),L.current)return r.createElement(r.Fragment,null,R.map(e=>r.createElement(E,{key:h(e),isPresent:!0,initial:!!c&&void 0,presenceAffectsLayout:d,mode:N},e)));R=[...R];let y=g.current.map(h),O=p.map(h),A=y.length;for(let e=0;e<A;e++){let t=y[e];-1!==O.indexOf(t)||w.has(t)||w.set(t,void 0)}return"wait"===N&&w.size&&(R=[]),w.forEach((e,t)=>{if(-1!==O.indexOf(t))return;let n=I.get(t);if(!n)return;let a=y.indexOf(t),i=e;i||(i=r.createElement(E,{key:h(n),isPresent:!1,onExitComplete:()=>{w.delete(t);let e=Array.from(I.keys()).filter(e=>!O.includes(e));if(e.forEach(e=>I.delete(e)),g.current=p.filter(n=>{let r=h(n);return r===t||e.includes(r)}),!w.size){if(!1===x.current)return;m(),s&&s()}},custom:o,presenceAffectsLayout:d,mode:N},n),w.set(t,i)),R.splice(a,0,i)}),R=R.map(e=>{let t=e.key;return w.has(t)?e:r.createElement(E,{key:h(e),isPresent:!0,presenceAffectsLayout:d,mode:N},e)}),r.createElement(r.Fragment,null,w.size?R:R.map(e=>(0,r.cloneElement)(e)))}}},function(e){e.O(0,[247,971,69,744],function(){return e(e.s=9988)}),_N_E=e.O()}]);